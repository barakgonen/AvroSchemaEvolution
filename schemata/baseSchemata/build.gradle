version '0.1.0'
/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */
apply plugin: 'java'
apply plugin: 'maven'
apply plugin: 'maven-publish'

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        // https://mvnrepository.com/artifact/com.commercehub.gradle.plugin/gradle-avro-plugin
//        compile group: 'com.commercehub.gradle.plugin', name: 'gradle-avro-plugin', version: '0.10.0'

        classpath "com.commercehub.gradle.plugin:gradle-avro-plugin:0.10.0"
    }
}

apply plugin: "com.commercehub.gradle.plugin.avro-base"


repositories {
    // Use jcenter for resolving dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
    mavenCentral()
}

dependencies{
    compile group: 'org.apache.avro', name: 'avro', version: '1.8.2'
    compile group: 'joda-time', name: 'joda-time', version: '2.7'
}

def generateAvro = tasks.register("generateAvro", com.commercehub.gradle.plugin.avro.GenerateAvroJavaTask) {
    source("src/main/avro")
    outputDir = file("dest/avro")
}

tasks.named("compileJava").configure {
    source(generateAvro)
}

task createPom{
    pom {
        project {
            groupId project.group
            artifactId project.name
            version project.version
        }
    }.writeTo('build/pom/' + project.name + '-' + project.version + '.pom')
}

publishing {
    publications {
        maven(MavenPublication) {
            groupId project.group
            artifactId project.name
            version project.version

            from components.java
        }
    }
}